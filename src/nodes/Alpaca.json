{
  "name": "Alpaca",
  "def": "Alpaca",
  "node_type": "main",
  "icon": "/assets/icons/alpaca.svg",
  "category": "Broker",
  "description": "Execute trades and get market data from Alpaca Markets",
  "color": "text-green-600",
  "size": { "width": 340, "height": 360 },
  "handles": [
    { "type": "target", "position": "left", "id": "input" },
    { "type": "source", "position": "right", "id": "output" }
  ],
  "auth": "GenericAuthModal",
  "authFields": [
    {
      "key": "credential_name",
      "label": "Credential Label",
      "type": "text",
      "default": "My Alpaca"
    },
    {
      "key": "api_key",
      "label": "API Key",
      "type": "password",
      "placeholder": "Your Alpaca API Key"
    },
    {
      "key": "secret_key",
      "label": "Secret Key",
      "type": "password",
      "placeholder": "Your Alpaca Secret Key"
    }
  ],
  "authAction": { "url": "/alpaca/auth-url", "method": "POST" },
  "action": {
    "url": "/alpaca/{{operation}}",
    "method": "{{method}}"
  },
  "fields": [
    {
      "key": "credential_id",
      "label": "Credential",
      "type": "select",
      "optionsSource": "credentialsApi",
      "placeholder": "Select credential",
      "required": true
    },
    {
      "key": "operation",
      "label": "Operation",
      "type": "select",
      "options": [
        { "id": "get_account", "name": "Get Account", "method": "GET" },
        { "id": "get_positions", "name": "Get Positions", "method": "GET" },
        { "id": "get_orders", "name": "Get Orders", "method": "GET" },
        { "id": "cancel_order", "name": "Cancel Orders", "method": "POST" },
        { "id": "get_candle", "name": "Get Historical Bars", "method": "POST" }
      ],
      "placeholder": "Select operation",
      "required": true
    },
    {
      "key": "symbol",
      "label": "Ticker Symbol",
      "type": "text",
      "placeholder": "e.g. AAPL",
      "required": true,
      "displayOptions": {
        "show": {
          "operation": ["get_candle"]
        }
      }
    },
    {
      "key": "interval",
      "label": "Interval",
      "type": "select",
      "options": [
        { "id": "1Min", "name": "1 min" },
        { "id": "5Min", "name": "5 min" },
        { "id": "15Min", "name": "15 min" },
        { "id": "1Hour", "name": "1 hour" },
        { "id": "1Day", "name": "1 day" }
      ],
      "placeholder": "Select interval",
      "required": true,
      "displayOptions": {
        "show": {
          "operation": ["get_candle"]
        }
      }
    },
    {
      "key": "lookback",
      "label": "Bars to Fetch",
      "type": "text",
      "placeholder": "e.g. 100",
      "required": true,
      "displayOptions": {
        "show": {
          "operation": ["get_candle"]
        }
      }
    }
  ]
}